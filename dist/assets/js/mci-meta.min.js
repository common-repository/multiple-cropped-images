"use strict";jQuery(function(e){function t(e,t){void 0===l[e]&&(l[e]=new Cropper(t.find(".mci-image")[0],{viewMode:2,dragMode:"move"}))}function i(e,t,i){var o=n(t),m=c(o.width,o.height);t.find(".mci-body").is(":visible")||r(t,0),l[e].replace(i),l[e].setAspectRatio(m),t.find(".mci-controls-container").show(),a(t)}function n(e){var t=JSON.parse(e.find(".mci-size option:selected").val());return{width:Math.ceil(parseFloat(t.width)),height:Math.ceil(parseFloat(t.height)),thumb_size:Math.ceil(parseFloat(t.thumb_size))}}function c(e,t){return 0===e||0===t?0:e/t}function o(e){return parseInt(e.find(".mci-image-id").val())}function a(t){e("html, body").animate({scrollTop:t.offset().top-32},"slow")}function r(e,t){e.toggleClass("toggled").closest(".mci").find(".mci-body").slideToggle(t)}var m=e("#mci-meta"),d=function(){var t=[];return e(".mci").not(".dummy").each(function(i,n){t.push(o(e(n)))}),t.length>0?Math.max.apply(Math,t):0}(),l=[];m.find(".sortable").sortable({connectWith:e(".mci").not(".dummy")}),m.find(".mci-add").click(function(t){var i=e(t.currentTarget).prevAll(".sortable"),n=i.find(".dummy").clone()[0].outerHTML.replace(/#ID#/g,++d);r(e(n).removeClass("dummy").appendTo(i).find(".mci-toggle"),0)}),e(document).on("click",".mci-remove",function(t){e(t.currentTarget).closest(".mci").remove()}),e(document).on("change keyup paste",".mci-title",function(t){var i=e(t.currentTarget);i.closest(".mci").find(".info-title").html(i.val())}),e(document).on("click",".mci-recrop:not(.disabled)",function(n){var c=e(n.currentTarget).closest(".mci"),a=o(c);t(a,c),i(a,c,c.find(".mci-image-original").val())}),m.on("change",".mci-upload",function(n){var c=e(n.currentTarget),a=c.closest(".mci"),r=o(a);t(r,a);var m=new FileReader;m.onload=function(e){i(r,a,e.target.result)},m.readAsDataURL(c[0].files[0])}),e(document).on("change","select",function(t){var i=e(t.currentTarget).closest(".mci"),a=o(i),r=n(i),m=c(r.width,r.height);l[a].setAspectRatio(m)}),e(document).on("submit","form",function(){e(".mci.dummy").remove(),e(".mci").not(".dummy").each(function(t,i){if(""!==e(i).find(".mci-image").attr("src")){var c=n(e(i)),a=o(e(i)),r=l[a].getCroppedCanvas({width:c.width,height:c.height}).toDataURL();e(i).find(".mci-image-base64").val(r),e(i).find(".mci-image-width").val(c.width),e(i).find(".mci-image-height").val(c.height),e(i).find(".mci-image-thumb_size").val(c.thumb_size)}})}),e(document).on("click",".mci-toggle",function(t){r(e(t.currentTarget),200)}),e(document).on("click",".cancel",function(t){var i=e(t.currentTarget).closest(".mci"),n=o(i);l[n].destroy(),i.find(".mci-controls-container").hide(),i.find(".mci-upload").val(null)}),e(document).on("click",".info-shortcode",function(t){var i=e(t.currentTarget),n=i.find(".notification");i.find("input")[0].select(),!n.is(":animated")&&document.execCommand("copy")&&n.fadeIn(600,function(){setTimeout(function(){n.fadeOut(500)},500)})})});